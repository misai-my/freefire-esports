<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Split View</title>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      --bg:#07090f;
      --bg2:#0b1020;
      --panel: rgba(20, 26, 38, .72);
      --panel2: rgba(14, 18, 28, .70);
      --line: rgba(255,255,255,.08);
      --ink:#f4f6ff;
      --muted:#aab1c5;

      --brand:#ffbd59;
      --brand2:#ff7733;
      --accent:#4dd3ff;

      --radius:16px;
      --radius-lg:22px;
      --shadow: 0 22px 70px rgba(0,0,0,.55);

      --divider-w: 6px;
      --min-pane: 240px;

      --topbar-h: 64px;

      color-scheme: dark;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Roboto, system-ui, -apple-system, Segoe UI, Arial;
      color:var(--ink);
      background:
        radial-gradient(900px 500px at 18% 12%, rgba(77,211,255,.15), transparent 60%),
        radial-gradient(700px 420px at 85% 18%, rgba(255,189,89,.12), transparent 60%),
        radial-gradient(900px 620px at 50% 110%, rgba(255,119,51,.10), transparent 60%),
        linear-gradient(180deg, var(--bg), var(--bg2));
      overflow:hidden;
    }

    body::before, body::after{
      content:"";
      position:fixed;
      inset:auto auto 0 0;
      width:520px; height:520px;
      border-radius:50%;
      border:10px solid rgba(77,211,255,.14);
      transform: translate(-45%, -35%);
      filter: blur(.2px);
      pointer-events:none;
    }
    body::after{
      inset: -120px 0 auto auto;
      width:420px; height:420px;
      border:10px solid rgba(77,211,255,.10);
      transform: translate(38%, 0%);
    }

    a{color:inherit}
    button{font:inherit}
    :focus-visible{
      outline: 2px solid rgba(77,211,255,.65);
      outline-offset: 2px;
      border-radius: 12px;
    }

    /* Topbar (matching your theme) */
    .topbar{
      height: calc(var(--topbar-h) + env(safe-area-inset-top));
      padding: calc(12px + env(safe-area-inset-top)) 12px 12px 12px;
      background: var(--panel);
      border-bottom: 1px solid var(--line);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      position: relative;
      z-index: 50;
    }

    .title{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:0;
    }
    .logo{
      width:36px;height:36px;border-radius:12px;
      background: linear-gradient(135deg, rgba(255,189,89,.25), rgba(77,211,255,.18));
      border:1px solid rgba(255,255,255,.10);
      display:grid;place-items:center;
      font-family: Orbitron, sans-serif;
      letter-spacing:.5px;
      color:var(--brand);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .title h1{
      margin:0;
      font-family: Orbitron, sans-serif;
      letter-spacing:.6px;
      font-size: 1.05rem;
      color: rgba(244,246,255,.94);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .title small{
      display:block;
      margin-top:2px;
      color: var(--muted);
      font-size:.78rem;
      font-weight:700;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .actions{
      display:flex;
      align-items:center;
      gap:10px;
      flex:0 0 auto;
    }

    .btn{
      padding: 9px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      color: rgba(244,246,255,.88);
      cursor:pointer;
      font-weight:900;
      font-size:.82rem;
      transition:.2s ease;
      white-space:nowrap;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .btn:hover{
      background: rgba(0,0,0,.28);
      box-shadow: 0 0 0 3px rgba(77,211,255,.10);
      border-color: rgba(77,211,255,.22);
    }
    .btn.brand{
      background: linear-gradient(135deg, rgba(255,189,89,.18), rgba(255,119,51,.10));
      border-color: rgba(255,189,89,.20);
    }
    .btn.brand:hover{
      box-shadow: 0 0 0 3px rgba(255,189,89,.12);
      border-color: rgba(255,189,89,.28);
    }

    /* Split layout: edge-to-edge */
    .wrap{
      height: calc(100vh - (var(--topbar-h) + env(safe-area-inset-top)));
      width: 100vw;
      padding: 0;
    }

    .split{
      height: 100%;
      width: 100%;
      display:grid;
      grid-template-columns: 1fr var(--divider-w) 1fr;
      grid-template-rows: 1fr;
      background: transparent;
    }

    .pane{
      min-width: var(--min-pane);
      min-height: var(--min-pane);
      overflow:hidden;
      position:relative;
    }

    /* Give panes the same glass edge feel but without margins */
    .pane::before{
      content:"";
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.10);
      pointer-events:none;
    }

    .frame{
      width:100%;
      height:100%;
      border:0;
      display:block;
      background: rgba(0,0,0,.18);
    }

    .divider{
      position:relative;
      background:
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border-left: 1px solid rgba(255,255,255,.10);
      border-right: 1px solid rgba(0,0,0,.35);
      cursor: col-resize;
      touch-action: none;
      user-select:none;
    }

    /* drag handle */
    .divider::after{
      content:"";
      position:absolute;
      left:50%; top:50%;
      width: 18px; height: 44px;
      transform: translate(-50%, -50%);
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 12px 40px rgba(0,0,0,.45);
    }
    .divider::before{
      content:"";
      position:absolute;
      left:50%; top:50%;
      width: 10px; height: 28px;
      transform: translate(-50%, -50%);
      border-radius: 999px;
      background:
        radial-gradient(circle at 50% 25%, rgba(77,211,255,.65), transparent 55%),
        radial-gradient(circle at 50% 50%, rgba(255,189,89,.55), transparent 55%),
        radial-gradient(circle at 50% 75%, rgba(77,211,255,.65), transparent 55%);
      opacity:.9;
      pointer-events:none;
    }

    .divider.dragging{
      box-shadow: inset 0 0 0 9999px rgba(77,211,255,.06);
      border-left-color: rgba(77,211,255,.22);
      border-right-color: rgba(77,211,255,.22);
    }

    /* Mobile: stack vertical */
    @media (max-width: 980px){
      body::before, body::after{display:none;}

      .actions{gap:8px}
      .btn{padding: 10px 12px; border-radius: 14px;}

      .split{
        grid-template-columns: 1fr;
        grid-template-rows: 1fr var(--divider-w) 1fr;
      }
      .divider{
        cursor: row-resize;
        border-left: 0;
        border-right: 0;
        border-top: 1px solid rgba(255,255,255,.10);
        border-bottom: 1px solid rgba(0,0,0,.35);
      }
      .divider::after{ width: 44px; height: 18px; }
      .divider::before{
        width: 28px; height: 10px;
        background:
          radial-gradient(circle at 25% 50%, rgba(77,211,255,.65), transparent 55%),
          radial-gradient(circle at 50% 50%, rgba(255,189,89,.55), transparent 55%),
          radial-gradient(circle at 75% 50%, rgba(77,211,255,.65), transparent 55%);
      }
    }

    @media (prefers-reduced-motion: reduce){
      *{transition:none !important; animation:none !important}
    }
  </style>
</head>

<body>
  <!-- TOPBAR -->
  <header class="topbar">
    <div class="title">
      <div class="logo">FF</div>
      <div style="min-width:0">
        <h1>Split View</h1>
        <small>Edge-to-edge • Drag the divider</small>
      </div>
    </div>

    <div class="actions">
      <a class="btn" href="home.html">← Back to Dashboard</a>
      <button class="btn brand" id="resetBtn" type="button">Reset Split</button>
    </div>
  </header>

  <!-- SPLIT -->
  <div class="wrap">
    <section class="split" id="split">
      <div class="pane" id="paneA">
        <iframe class="frame" id="frameA" title="Left Pane"></iframe>
      </div>

      <div class="divider" id="divider" role="separator" aria-label="Resize split panes" aria-orientation="vertical" tabindex="0"></div>

      <div class="pane" id="paneB">
        <iframe class="frame" id="frameB" title="Right Pane"></iframe>
      </div>
    </section>
  </div>

  <script>
    /***********************
     * Split View — themed to match your dashboard
     * - No sidebar, no margins
     * - Buttons: Back + Reset only
     * - Drag divider (mouse/touch)
     * - Query params supported:
     *   split-view.html?left=character.html&right=weapon.html
     ***********************/
    const KEY_RATIO = 'ff_split_ratio_v1';
    const split = document.getElementById('split');
    const divider = document.getElementById('divider');
    const resetBtn = document.getElementById('resetBtn');
    const frameA = document.getElementById('frameA');
    const frameB = document.getElementById('frameB');

    const mqStack = window.matchMedia('(max-width: 980px)');
    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

    function getParams(){
      const u = new URL(location.href);
      return {
        left:  u.searchParams.get('left')  || 'character.html',
        right: u.searchParams.get('right') || 'weapon.html'
      };
    }

    function setFrames(){
      const { left, right } = getParams();
      frameA.src = left;
      frameB.src = right;
    }

    function isStacked(){ return mqStack.matches; }

    function applyRatio(ratio){
      ratio = clamp(ratio, 0.1, 0.9);

      const rect = split.getBoundingClientRect();
      const size = isStacked() ? rect.height : rect.width;
      const minFrac = clamp(parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--min-pane')) || 240, 120, 420) / Math.max(1, size);

      ratio = clamp(ratio, minFrac, 1 - minFrac);

      if (isStacked()){
        const topPx = Math.round(rect.height * ratio);
        split.style.gridTemplateRows = `${topPx}px var(--divider-w) 1fr`;
        split.style.gridTemplateColumns = `1fr`;
        divider.setAttribute('aria-orientation','horizontal');
      }else{
        const leftPx = Math.round(rect.width * ratio);
        split.style.gridTemplateColumns = `${leftPx}px var(--divider-w) 1fr`;
        split.style.gridTemplateRows = `1fr`;
        divider.setAttribute('aria-orientation','vertical');
      }

      try{ localStorage.setItem(KEY_RATIO, String(ratio)); }catch(_){}
      return ratio;
    }

    function readRatio(){
      const raw = localStorage.getItem(KEY_RATIO);
      const n = raw ? parseFloat(raw) : NaN;
      return Number.isFinite(n) ? n : 0.5;
    }

    let ratio = 0.5;

    function resetSplit(){
      ratio = 0.5;
      applyRatio(ratio);
    }

    // Pointer drag (mouse + touch)
    let dragging = false;
    let activePointerId = null;

    function onPointerDown(e){
      dragging = true;
      activePointerId = e.pointerId;
      divider.classList.add('dragging');
      divider.setPointerCapture?.(activePointerId);
      e.preventDefault();
    }

    function onPointerMove(e){
      if (!dragging || e.pointerId !== activePointerId) return;

      const rect = split.getBoundingClientRect();
      if (isStacked()){
        const y = e.clientY - rect.top;
        ratio = y / Math.max(1, rect.height);
      }else{
        const x = e.clientX - rect.left;
        ratio = x / Math.max(1, rect.width);
      }
      applyRatio(ratio);
    }

    function stopDrag(){
      if (!dragging) return;
      dragging = false;
      divider.classList.remove('dragging');
      activePointerId = null;
    }

    divider.addEventListener('pointerdown', onPointerDown);
    window.addEventListener('pointermove', onPointerMove, { passive:false });
    window.addEventListener('pointerup', stopDrag);
    window.addEventListener('pointercancel', stopDrag);
    window.addEventListener('blur', stopDrag);

    // Keyboard resize (nice bonus)
    divider.addEventListener('keydown', (e) => {
      const step = 0.03;
      if (e.key === 'ArrowLeft' || e.key === 'ArrowUp'){
        ratio -= step; applyRatio(ratio); e.preventDefault();
      }
      if (e.key === 'ArrowRight' || e.key === 'ArrowDown'){
        ratio += step; applyRatio(ratio); e.preventDefault();
      }
      if (e.key === 'Enter' || e.key === ' '){
        resetSplit(); e.preventDefault();
      }
    });

    resetBtn.addEventListener('click', resetSplit);

    // Resize handling
    function syncLayout(){
      applyRatio(ratio);
    }
    mqStack.addEventListener?.('change', syncLayout);
    window.addEventListener('resize', syncLayout);

    // Init
    setFrames();
    ratio = readRatio();
    applyRatio(ratio);
  </script>
</body>
</html>
